# wm-itemstructure-effect-2

視覚的ワーキングメモリと物体配置構造が視覚探索に与える影響を検証する心理学実験

## 概要

本プロジェクトは、制限された視野を移動して行う視覚探索場面において、視覚的ワーキングメモリおよび物体の配置構造が探索効率に与える影響を解明することを目的とした実験プログラムです。jsPsych v7を使用してブラウザ上で実行される心理学実験として実装されています。本プログラムはPavloviaにホスティングされることを想定して作成されており、Pavlovia統合機能を含んでいます。

**重要：** 本実験はパソコンからのアクセスのみ対応しており、スマートフォンやタブレット端末からのアクセスは自動的にブロックされます。

## 主な機能

### 実験条件

本実験では以下の3つの独立変数を操作しています：

1. **表示条件（被験者間要因）**
   - 全画面条件：画面全体に図形が表示される
   - ウィンドウ条件：小さな窓をドラッグして移動させながら探索
   - スクロール条件：背景をドラッグしてスクロールしながら探索

2. **配置構造（被験者内要因）**
   - 構造化条件：図形が規則的なグリッドに配置される
   - 非構造化条件：図形がランダムに配置される

3. **記憶負荷（被験者内要因）**
   - 記憶負荷あり：視覚探索前に4×4グリッドの位置記憶課題を実施
   - 記憶負荷なし：記憶課題なしで視覚探索のみ実施

### カウンターバランス設計

記憶負荷条件の順序は参加者ごとにランダムに割り当てられます：
- **条件A**: 第1ブロック（30試行）= 記憶負荷あり → 第2ブロック（30試行）= 記憶負荷なし
- **条件B**: 第1ブロック（30試行）= 記憶負荷なし → 第2ブロック（30試行）= 記憶負荷あり

この設計により、順序効果を統制しながら記憶負荷の影響を評価できます。

### 実験の流れ

1. デバイスチェック（モバイル/タブレット端末の場合は自動的にブロック）
2. インフォームドコンセント
3. 基本情報（ワーカー名、年齢、性別）の入力
4. 参加条件の確認（パソコン使用、マウス操作、適切な環境）
5. 実験説明（割り当てられた条件に応じた説明）
6. フルスクリーンモードへの移行
7. 練習試行（3回、繰り返し可能）
8. 本番試行（第1ブロック：30試行）
9. 中間説明（記憶課題の有無が切り替わる）
10. 本番試行（第2ブロック：30試行）
11. 結果表示と実験に対するコメント収集
12. 確認ID発行
13. データ送信（Pavlovia経由）

## 必要要件

- **デバイス**: パソコン（デスクトップまたはノートPC）のみ対応
  - スマートフォンやタブレット端末からのアクセスは自動的にブロックされます
- **入力デバイス**: マウスまたはタッチパッド（タッチ操作は非対応）
- **ブラウザ**: モダンブラウザ（Chrome、Firefox、Safari、Edge等）
- **その他の要件**:
  - JavaScript有効化
  - フルスクリーンモード対応
  - インターネット接続（jsPsychライブラリおよびPavloviaとの通信に必要）
- **推奨環境**: 集中して実験に取り組むことのできる静かな場所

## 使用方法

### Pavloviaでの実行

本実験プログラムはPavloviaプラットフォームでの実行を想定して設計されています：

1. Pavloviaアカウントにログイン
2. プロジェクトとして本リポジトリをアップロード
3. Pavloviaが自動的に必要なライブラリ（jspsych-pavlovia）を提供
4. 実験URLを参加者に配布

### ローカルでのテスト

ローカル環境でテストする場合：

1. ウェブサーバーを起動（例: Python `http.server`）
2. ブラウザで `index.html` にアクセス
3. 注意: Pavlovia統合機能はローカル環境では動作しません

### データの収集

実験終了時に、jsPsychおよびPavloviaの機能によってデータが自動的に収集・保存されます。収集されるデータには主に以下の情報が含まれます：

- **参加者情報**: ワーカー名、年齢、性別
- **実験条件**: 表示条件（被験者間割り当て）、配置構造、記憶負荷条件、カウンターバランス条件
- **視覚探索課題データ**: 
  - 各試行の反応時間
  - 正誤データ
  - マウス移動経路と総移動距離
  - ターゲット図形の色と形状
- **記憶課題データ**: 
  - 記憶課題の成績（正答率）
  - 回答パターン
- **その他のデータ**:
  - 画面解像度（自動取得）
  - 確認ID（6桁の数字）
  - 実験に対するコメント（任意）
  - タイムスタンプ情報

## プロジェクト構造

```
wm-itemstructure-effect-2/
├── index.html              # メインの実験ファイル（jsPsych v7実装）
├── styles.css              # スタイルシート（実験画面のスタイル定義）
├── screen_shots/           # 説明画面で使用するスクリーンショット
│   ├── 1_target_presentation.png      # ターゲット図形の表示例
│   ├── 2_fullscreen.png               # 全画面条件の例
│   ├── 3_window_initial.png           # ウィンドウ条件（初期状態）
│   ├── 4_window_after_move.png        # ウィンドウ条件（移動後）
│   ├── 5_scroll_initial.png           # スクロール条件（初期状態）
│   ├── 6_scroll_after_move.png        # スクロール条件（移動後）
│   ├── 7_memory_task_presentation.png # 記憶課題の提示画面
│   └── 8_memory_task_response.png     # 記憶課題の回答画面
├── preview_pages/          # 開発用プレビューHTMLファイル
├── tests/                  # テスト関連ファイル
├── LICENSE                 # MITライセンス
├── .gitignore              # Git除外設定
└── README.md              # 本ファイル

注意: index.htmlで参照されている lib/jspsych-7-pavlovia-2022.1.1.js は
Pavloviaプラットフォームにアップロード時に自動的に提供されるライブラリです。
ローカル実行時は別途用意する必要があります。
```

## 実験パラメータ

以下のパラメータは `index.html` 内のparamsオブジェクトで調整可能：

- `numObjects`: 1試行あたりの図形数（デフォルト: 25）
- `objectSize`: すべての図形のサイズ（デフォルト: 40px、固定値）
- `windowWidth/Height`: ウィンドウ・スクロール条件の表示窓サイズ（画面サイズの1/3）
- `trialsPerCondition`: 各条件あたりの試行数（デフォルト: 15、合計60試行）
- `memoryGridSize`: 記憶課題のグリッドサイズ（デフォルト: 4×4）
- `memoryPositions`: 記憶する位置の数（デフォルト: 4）
- `targetTolerance`: ターゲット検出の許容範囲（デフォルト: 0.8、オブジェクトサイズの80%）
- `colors`: 使用可能な色（red, blue, green, yellow, purple）
- `shapes`: 使用可能な形状（circle, triangle, square, diamond）

### カウンターバランス設定

記憶負荷条件の順序はランダムに割り当てられます：
- 前半30試行が記憶課題あり、後半30試行が記憶課題なし
- または、前半30試行が記憶課題なし、後半30試行が記憶課題あり

## 技術仕様

- **フレームワーク**: jsPsych v7（CDN経由で読み込み）
- **プラグイン**:
  - `@jspsych/plugin-html-keyboard-response` - キーボード応答用
  - `@jspsych/plugin-survey-text` - テキスト入力フォーム用
  - `@jspsych/plugin-preload` - 画像プリロード用
  - `@jspsych/plugin-instructions` - 教示画面用
  - `@jspsych/plugin-canvas-keyboard-response` - Canvas描画用
  - `@jspsych/plugin-survey-multi-choice` - 多肢選択用
  - `jsPsychPavlovia` - Pavlovia統合用（Pavlovia環境で自動提供）
- **描画技術**: HTML5 Canvas API
- **スタイリング**: カスタムCSS（styles.css）
- **データ保存**: Pavlovia統合機能
- **デバイス検出**: User Agentおよびタッチ機能による自動判定
- **フルスクリーン管理**: Fullscreen API（自動制御とイベントリスナー）

### 技術的な特徴

- **レスポンシブ設計**: 画面解像度の自動検出と適応
- **マウストラッキング**: 視覚探索中のマウス移動経路を完全記録
- **条件分岐表示**: 参加者の割り当て条件に応じた動的な教示画面生成
- **データ検証**: フォーム入力の妥当性チェック
- **プログレス管理**: 試行番号と進捗状況の追跡

## トラブルシューティング

### よくある問題と解決方法

**Q: モバイル端末でアクセスできない**  
A: 本実験はパソコンのみ対応です。デスクトップまたはノートPCからアクセスしてください。

**Q: フルスクリーンモードが解除されてしまう**  
A: ESCキーを押すとフルスクリーンモードが解除されます。実験を中断したい場合以外は、ESCキーを押さないでください。

**Q: 練習試行でターゲットが見つからない**  
A: 練習試行では、ターゲット図形が初期表示の窓の外に配置されます。窓やスクロールを動かして探索してください。

**Q: データが保存されない**  
A: Pavlovia環境で実行していることを確認してください。ローカル環境ではPavlovia統合機能は動作しません。

**Q: 確認IDを忘れてしまった**  
A: 確認IDは実験終了画面に表示されます。メモを取ることを推奨します。再発行はできません。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルをご覧ください。

## 著者・連絡先

- **研究実施者**: 野﨑 優晴（東京学芸大学大学院 連合学校教育学研究科 博士課程）
- **指導教員**: 関口 貴裕（東京学芸大学 教育心理学講座 教授）
- **研究に関するお問い合わせ先**: r241004y@st.u-gakugei.ac.jp

## 謝辞

本実験プログラムは認知心理学研究のために開発されました。jsPsychコミュニティおよびPavloviaコミュニティに感謝いたします。
